<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script type="text/javascript" src="https://dl.frontapp.com/libs/frontjs.min.js"></script>
    <script>
        Front.contextUpdates.subscribe(context => {
            switch (context.type) {
                case 'noConversation':
                    console.log('No conversation selected');
                    break;
                case 'singleConversation':
                    console.log('Selected conversation:', context.conversation);
                    break;
                case 'multiConversations':
                    console.log('Multiple conversations selected', context.conversations);
                    break;
                default:
                    console.error(`Unsupported context type: ${context.type}`);
                    break;
            }
        })
        function getSelectedText() {
            var selectedText = '';

            // window.getSelection 
            if (window.getSelection) {
                selectedText = window.getSelection();
            }
            // document.getSelection 
            else if (document.getSelection) {
                selectedText = document.getSelection();
            }
            // document.selection 
            else if (document.selection) {
                selectedText =
                    document.selection.createRange().text;
            } else return;
            // To write the selected text into the textarea 
            document.testform.selectedtext.value = selectedText;
        }
    </script>
</head>

<body>
    <center>
        <p>Select any part of this sentence
            and press the button</p>

        <!--Button to invoke the  
         function to get the selected text-->
        <input type="button" value="Get Selection" onmousedown="getSelectedText()">

        <!--Form to show the selected text as output-->
        <form name="testform">
            <textarea name="selectedtext" rows="5" cols="20"></textarea>
        </form>
    </center>

</body>

</html>